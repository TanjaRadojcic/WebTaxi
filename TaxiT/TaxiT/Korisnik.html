<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Pink Taxi</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-pink.css">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="Korisnik.css">
    <script src="Scripts/jquery-1.10.2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            let ulogovani = localStorage.getItem("ulogovani");
            let text = "Dobrodošli " + ulogovani + "!";
            let koje = "";
            let trenutniKorisnik = "";

            $.ajax({
                type: 'POST',
                url: '/api/Find',
                data: JSON.stringify(ulogovani),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data != null) {
                        trenutniKorisnik = data;
                        localStorage.setItem("ulogovaniId", data.Id);
                        switch (data.Uloga) {
                            case 0:
                                koje = "musterija";
                                $(".musterija").css("display", "inline");
                                $("#pregledProfilaDivK").css("display", "none");
                                $("#izmenaProfilaDivK").css("display", "none");
                                $("#dodajVoznjuDivK").css("display", "none");
                                $("#tabelaMojeVoznjeK").css("display", "inline");
                                $("#pretragaK").css("display", "inline");
                                
                                
                                $("#homeK").click();
                                $(".dispecer").css("display", "none");

                                $(".vozac").css("display", "none");
                                break;
                            case 1:
                                koje = "dispecer";
                                $(".musterija").css("display", "none");

                                $(".dispecer").css("display", "inline");
                                $("#pregledProfilaDivD").css("display", "none");
                                $("#izmenaProfilaDivD").css("display", "none");
                                $("#dodajVozacaDivD").css("display", "none");
                                $(".vozac").css("display", "none");
                                $("#dodajKomentarD").css("display", "none");
                                $("#prikaziKomentarD").css("display", "none");
                                $("#tabeleD").css("display", "inline");
                                break;
                            case 2:
                                koje = "vozac";
                                $(".dispecer").css("display", "none");

                                $(".musterija").css("display", "none");
                                
                                $(".vozac").css("display", "inline");
                                $("#pregledProfilaDivV").css("display", "none");
                                $("#izmenaProfilaDivV").css("display", "none");
                                $("#dodajKomentarV").css("display", "none");
                                $("#prikaziKomentarV").css("display", "none");
                                $("#tabeleV").css("display", "inline");
                                $("#uspesnaVoznjaV").css("display", "none");
                                $("#dodajKomentarNeuspesnaV").css("display", "none");
                                localStorage.setItem("ulogovaniTip", data.Automobil.TipAutomobila);
                                localStorage.setItem("ulogovaniStatus", data.Zauzet);
                                
                                break;

                        }
                        
                    }

                },
                error: function (errorData) {

                }
            })

            $("#odjavaK").click(function () {
                localStorage.removeItem("ulogovani");
                let koje = "";
                let trenutniKorisnik = "";
                $(location).attr('href', 'Index.html');
            });

            $("#homeK").click(function () {

                $("#pregledProfilaDivK").css("display", "none");
                $("#izmenaProfilaDivK").css("display", "none");
                $("#dodajVoznjuDivK").css("display", "none");
                $("#dodajKomentarK").css("display", "none");
                $("#prikaziKomentarK").css("display", "none");
                $("#dodajKomentarOtkaziK").css("display", "none");
                $("#pretragaK").css("display", "inline");
                $("#tabelaMojeVoznjeK").html("");
                $.get("/api/Voznja", function (data, status) {
                    
                    let tableOfProducts = "<table border=\"1\" id=\"musterijaVoznje\"><tr><td colspan=\"9\" align=\"center\">Moje voznje</td></tr><tr><td>Datum</td><td>Početna lokacija</td><td>Odredište</td><td>Vozač</td><td>Iznos</td><td>Ocena</td><td>Status</td><td>Komentar</td><td></td><td></td></tr>";
                        for (voznja in data) {
                            if (data[voznja].Musterija == trenutniKorisnik.KorisnickoIme) {
                                tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Odrediste.Adresa.Ulica} ${data[voznja].Odrediste.Adresa.Broj}</td><td>${data[voznja].Vozac}</td><td>${data[voznja].Iznos}</td>`;
                                tableOfProducts += `<td>${data[voznja].Komentar.Ocena}</td>`;

                                switch (data[voznja].Status) {
                                    case 0:
                                        tableOfProducts += `<td>Kreirana-Na čekanju</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 1:
                                        tableOfProducts += `<td>Formirana</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 2:
                                        tableOfProducts += `<td>Obrađena</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 3:
                                        tableOfProducts += `<td>Prihvaćena</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 4:
                                        tableOfProducts += `<td>Otkazana</td>`;
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                        break;
                                    case 5:
                                        tableOfProducts += `<td>Uspešna</td>`;
                                        if (data[voznja].Komentar.Opis == null) {
                                            tableOfProducts += `<td><button id="dodajKomentar${data[voznja].Id}" type="button" onclick="dodajKomentarClick(${data[voznja].Id});">Dodaj komentar</button ></td>`;

                                        } else {
                                            tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                        }
                                        break;
                                    case 6:
                                        tableOfProducts += `<td>Neuspešna</td>`;
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                        break;

                                }
                                
                                if (data[voznja].Status == 0) {

                                    tableOfProducts += `<td><button id="otkaziVoznju${data[voznja].Id}" type="button" onclick="otkaziVoznjuClick(${data[voznja].Id});">Otkazi Voznju</button></td>`;
                                    tableOfProducts += `<td><button id="izmeniVoznju${data[voznja].Id}" type="button" onclick="izmeniVoznjuClick(${data[voznja].Id});">Izmeni Voznju</button></td>`;
                                } else {
                                    tableOfProducts += `<td><button id="otkaziVoznju${data[voznja].Id}" type="button" onclick="otkaziVoznjuClick(${data[voznja].Id});" disabled>Otkazi Voznju</button></td>`;
                                    tableOfProducts += `<td><button id="izmeniVoznju${data[voznja].Id}" type="button" onclick="izmeniVoznjuClick(${data[voznja].Id});" disabled>Izmeni Voznju</button></td>`;

                                }
                            }
                        }
                        tableOfProducts += "</table>";
                        $("#tabelaMojeVoznjeK").append(tableOfProducts);
                    
                });


                $("#tabelaMojeVoznjeK").css("display", "inline");


            });

            
            $("#refreshK").click(function () {

                $("#pregledProfilaDivK").css("display", "none");
                $("#izmenaProfilaDivK").css("display", "none");
                $("#dodajVoznjuDivK").css("display", "none");
                $("#dodajKomentarK").css("display", "none");
                $("#prikaziKomentarK").css("display", "none");
                $("#dodajKomentarOtkaziK").css("display", "none");
                $("#pretragaK").css("display", "inline");

                document.getElementById('cenaOdK').value = '';
                document.getElementById('cenaDoK').value = '';
                document.getElementById('ocenaPretragaOdK').selectedIndex = 0;
                document.getElementById('ocenaPretragaDoK').selectedIndex = 0;
                document.getElementById('statusPretragaK').selectedIndex = 0;
                document.getElementById('DatumOdK').value = '';
                document.getElementById('DatumDoK').value = '';

                $("#tabelaMojeVoznjeK").html("");
                $.get("/api/Voznja", function (data, status) {

                    let tableOfProducts = "<table border=\"1\" id=\"musterijaVoznje\"><tr><td colspan=\"9\" align=\"center\">Moje voznje</td></tr><tr><td>Datum</td><td>Početna lokacija</td><td>Odredište</td><td>Vozač</td><td>Iznos</td><td>Status</td><td>Komentar</td><td></td><td></td></tr>";
                    for (voznja in data) {
                        if (data[voznja].Musterija == trenutniKorisnik.KorisnickoIme) {
                            tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Odrediste.Adresa.Ulica} ${data[voznja].Odrediste.Adresa.Broj}</td><td>${data[voznja].Vozac}</td><td>${data[voznja].Iznos}</td>`;


                            switch (data[voznja].Status) {
                                case 0:
                                    tableOfProducts += `<td>Kreirana-Na čekanju</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 1:
                                    tableOfProducts += `<td>Formirana</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 2:
                                    tableOfProducts += `<td>Obrađena</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 3:
                                    tableOfProducts += `<td>Prihvaćena</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 4:
                                    tableOfProducts += `<td>Otkazana</td>`;
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                    break;
                                case 5:
                                    tableOfProducts += `<td>Uspešna</td>`;
                                    if (data[voznja].Komentar.Opis == null) {
                                        tableOfProducts += `<td><button id="dodajKomentar${data[voznja].Id}" type="button" onclick="dodajKomentarClick(${data[voznja].Id});">Dodaj komentar</button ></td>`;

                                    } else {
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                    }
                                    break;
                                case 6:
                                    tableOfProducts += `<td>Neuspešna</td>`;
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                    break;

                            }

                            if (data[voznja].Status == 0) {

                                tableOfProducts += `<td><button id="otkaziVoznju${data[voznja].Id}" type="button" onclick="otkaziVoznjuClick(${data[voznja].Id});">Otkazi Voznju</button></td>`;
                                tableOfProducts += `<td><button id="izmeniVoznju${data[voznja].Id}" type="button" onclick="izmeniVoznjuClick(${data[voznja].Id});">Izmeni Voznju</button></td>`;
                            } else {
                                tableOfProducts += `<td><button id="otkaziVoznju${data[voznja].Id}" type="button" onclick="otkaziVoznjuClick(${data[voznja].Id});" disabled>Otkazi Voznju</button></td>`;
                                tableOfProducts += `<td><button id="izmeniVoznju${data[voznja].Id}" type="button" onclick="izmeniVoznjuClick(${data[voznja].Id});" disabled>Izmeni Voznju</button></td>`;

                            }
                        }
                    }
                    tableOfProducts += "</table>";
                    $("#tabelaMojeVoznjeK").append(tableOfProducts);

                });


                $("#tabelaMojeVoznjeK").css("display", "inline");


            });

            $("#pretraziK").click(function () {

                $("#pregledProfilaDivK").css("display", "none");
                $("#izmenaProfilaDivK").css("display", "none");
                $("#dodajVoznjuDivK").css("display", "none");
                $("#dodajKomentarK").css("display", "none");
                $("#prikaziKomentarK").css("display", "none");
                $("#dodajKomentarOtkaziK").css("display", "none");
                $("#pretragaK").css("display", "inline");
                $("#tabelaMojeVoznjeK").html("");

                let e = document.getElementById('statusPretragaK');
                let selValue = e.options[e.selectedIndex].value;
                let statusPretrage = selValue;

                let datumOd = `${$('#DatumOdK').val()}`;
                if (datumOd == "") {
                    datumOd = new Date(2018, 0, 0);
                } else {
                    datumOd = (Date)(datumOd);
                }

                let datumDo = `${$('#DatumDoK').val()}`;
                if (datumDo == "") {
                    datumDo = new Date();
                } else {
                    datumDo = (Date)(datumDo);
                }

                let e1 = document.getElementById('ocenaPretragaOdK');
                let selValue1 = e1.options[e1.selectedIndex].value;
                let ocenaOd = selValue1;

                let e2 = document.getElementById('ocenaPretragaDoK');
                let selValue2 = e2.options[e2.selectedIndex].value;
                let ocenaDo = selValue2;

                let cenaOd = `${$('#cenaOdK').val()}`;
                if (cenaOd == "") {
                    cenaOd = 0;
                }

                let cenaDo = `${$('#cenaDoK').val()}`;
                if (cenaDo == "") {
                    cenaDo = 9999;
                }

                let e3 = document.getElementById('SortK');
                let selValue3 = e3.options[e3.selectedIndex].value;
                let sort = selValue3;

                $.get("/api/Voznja", function (data, status) {

                    let tableOfProducts = "<table border=\"1\" id=\"musterijaVoznje\"><tr><td colspan=\"9\" align=\"center\">Moje voznje</td></tr><tr><td>Datum</td><td>Početna lokacija</td><td>Odredište</td><td>Vozač</td><td>Iznos</td><td>Ocena</td><td>Status</td><td>Komentar</td><td></td><td></td></tr>";
                    for (voznja in data) {
                        if (data[voznja].Musterija == trenutniKorisnik.KorisnickoIme) {
                            var datum = (Date)(data[voznja].Datum);
                            

                            if ((data[voznja].Status == statusPretrage || statusPretrage == -1) && (data[voznja].Iznos >= cenaOd && data[voznja].Iznos <= cenaDo) && (data[voznja].Komentar.Ocena >= ocenaOd && data[voznja].Komentar.Ocena <= ocenaDo)) {

                                tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Odrediste.Adresa.Ulica} ${data[voznja].Odrediste.Adresa.Broj}</td><td>${data[voznja].Vozac}</td><td>${data[voznja].Iznos}</td>`;

                                tableOfProducts += `<td>${data[voznja].Komentar.Ocena}</td>`;
                                switch (data[voznja].Status) {
                                    case 0:
                                        tableOfProducts += `<td>Kreirana-Na čekanju</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 1:
                                        tableOfProducts += `<td>Formirana</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 2:
                                        tableOfProducts += `<td>Obrađena</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 3:
                                        tableOfProducts += `<td>Prihvaćena</td>`;
                                        tableOfProducts += `<td>Nema komentara</td>`;
                                        break;
                                    case 4:
                                        tableOfProducts += `<td>Otkazana</td>`;
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                        break;
                                    case 5:
                                        tableOfProducts += `<td>Uspešna</td>`;
                                        if (data[voznja].Komentar.Opis == null) {
                                            tableOfProducts += `<td><button id="dodajKomentar${data[voznja].Id}" type="button" onclick="dodajKomentarClick(${data[voznja].Id});">Dodaj komentar</button ></td>`;

                                        } else {
                                            tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                        }
                                        break;
                                    case 6:
                                        tableOfProducts += `<td>Neuspešna</td>`;
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClick(${data[voznja].Id});">Vidi komentar</button ></td>`;

                                        break;

                                }
                                
                                if (data[voznja].Status == 0) {

                                    tableOfProducts += `<td><button id="otkaziVoznju${data[voznja].Id}" type="button" onclick="otkaziVoznjuClick(${data[voznja].Id});">Otkazi Voznju</button></td>`;
                                    tableOfProducts += `<td><button id="izmeniVoznju${data[voznja].Id}" type="button" onclick="izmeniVoznjuClick(${data[voznja].Id});">Izmeni Voznju</button></td>`;
                                } else {
                                    tableOfProducts += `<td><button id="otkaziVoznju${data[voznja].Id}" type="button" onclick="otkaziVoznjuClick(${data[voznja].Id});" disabled>Otkazi Voznju</button></td>`;
                                    tableOfProducts += `<td><button id="izmeniVoznju${data[voznja].Id}" type="button" onclick="izmeniVoznjuClick(${data[voznja].Id});" disabled>Izmeni Voznju</button></td>`;

                                }
                            }
                        }
                    }
                    tableOfProducts += "</table>";
                    $("#tabelaMojeVoznjeK").append(tableOfProducts);

                });


                $("#tabelaMojeVoznjeK").css("display", "inline");


            });

            

            $("#pregledProfilaK").click(function () {

                $("#pregledProfilaDivK").css("display", "inline");
                $("#izmenaProfilaDivK").css("display", "none");
                $("#dodajVoznjuDivK").css("display", "none");
                $("#tabelaMojeVoznjeK").css("display", "none");
                $("#pretragaK").css("display", "none");

                $("#korisnickoImeK").text(trenutniKorisnik.KorisnickoIme);
                $("#lozinkaK").text(trenutniKorisnik.Lozinka);
                $("#imeK").text(trenutniKorisnik.Ime);
                $("#prezimeK").text(trenutniKorisnik.Prezime);
                if (trenutniKorisnik.Pol == 0) {
                    let musko = "<i class=\"fa fa-mars w3-xlarge\"></i>";
                    $("#polK").html(musko);
                } else {
                    let zensko = "<i class=\"fa fa-venus w3-xlarge\"></i>";
                    $("#polK").html(zensko);
                }
                $("#jmbgK").html(trenutniKorisnik.JMBG);
                $("#kontaktK").html(trenutniKorisnik.Kontakt);
                $("#emailK").html(trenutniKorisnik.Email);

            });

            $("#izmenaProfilaK").click(function () {

                $("#izmenaProfilaDivK").css("display", "inline");
                $("#pregledProfilaDivK").css("display", "none");
                $("#dodajVoznjuDivK").css("display", "none");
                $("#tabelaMojeVoznjeK").css("display", "none");
                $("#pretragaK").css("display", "none");

                let izmena = "<table class=\"w3-large\" border=1>";
                izmena += " <tr><td>Korisničko ime</td><td><input type=\"text\" name=\"KorisnickoIme\" id=\"korisnickoime\" value=\"" + trenutniKorisnik.KorisnickoIme + "\" required /></td></tr>";
                izmena += " <tr><td>Lozinka</td><td><input type=\"text\" name=\"Lozinka\" id=\"lozinka1\" value=\"" + trenutniKorisnik.Lozinka + "\" required /></td></tr>";
                izmena += " <tr><td>Ime</td><td><input type=\"text\" name=\"Ime\" id=\"ime1\" value=\" " + trenutniKorisnik.Ime + "\" required /></td></tr>";
                izmena += " <tr><td>Prezime</td><td><input type=\"text\" name=\"Prezime\" value=\" " + trenutniKorisnik.Prezime + "\" id=\"prezime1\" required /></td></tr>";
                
                izmena += " <tr><td>JMBG</td><td><input type=\"text\" name=\"JMBG\" id=\"jmbg1\" pattern=\"[0-9]{13}\" minlength=\"13\" maxlength=\"13\" value=\"" + trenutniKorisnik.JMBG + "\" required /></td></tr>";
                izmena += " <tr><td>Kontakt</td><td><input type=\"text\" name=\"Kontakt\" id=\"kontakt1\" minlength=\"6\" value=\" " + trenutniKorisnik.Kontakt + "\" required /></td></tr>";
                izmena += " <tr><td>Email</td><td><input type=\"email\" name=\"Email\" id=\"email1\" value=\" " + trenutniKorisnik.Email + "\" required /></td></tr></table>";

                $("#tabelaIzmenaK").html(izmena);

            });

            $("#izmeniK").click(function () {
                let korisnik = {
                    Id: trenutniKorisnik.Id,
                    KorisnickoIme: `${$('#korisnickoime').val()}`,
                    Lozinka: `${$('#lozinka1').val()}`,
                    Ime: `${$('#ime1').val()}`,
                    Prezime: `${$('#prezime1').val()}`,
                    Pol: trenutniKorisnik.Pol,
                    JMBG: `${$('#jmbg1').val()}`,
                    Kontakt: `${$('#kontakt1').val()}`,
                    Email: `${$('#email1').val()}`,
                    Voznje: trenutniKorisnik.Voznje,
                    Uloga: trenutniKorisnik.Uloga,
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Korisnik/' + trenutniKorisnik.Id,
                    data: JSON.stringify(korisnik),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert("Uspesna izmena");
                            localStorage.setItem("ulogovani", korisnik.KorisnickoIme);
                            $(location).attr('href', 'Korisnik.html');
                        }
                        else {
                            alert("Korisnicko ime je zauzeto!");
                        }
                    },
                    error: function (errorData) {

                    }
                })
            });


            $("#PlusK").click(function () {

                $("#izmenaProfilaDivK").css("display", "none");
                $("#pregledProfilaDivK").css("display", "none");
                $("#dodajVoznjuDivK").css("display", "inline");
                $("#tabelaMojeVoznjeK").css("display", "none");
                $("#pretragaK").css("display", "none");

            });

            $("#dodajVoznjuK").click(function () {
                let adresa = {
                    Ulica: `${$('#ulicaK').val()}`,
                    Broj: `${$('#brojK').val()}`,
                    Mesto: `${$('#mestoK').val()}`,
                    Zip: `${$('#zipK').val()}`,
                };
                let lokacija = {
                    X: `${$('#xK').val()}`,
                    Y: `${$('#yK').val()}`,
                    Adresa: adresa,
                };

                let e = document.getElementById('autoK');
                let selValue = e.options[e.selectedIndex].text;

                let Voznja = {
                    Musterija: trenutniKorisnik.KorisnickoIme,
                    PocetnaLokacija: lokacija,
                    TipAutomobila: selValue,
                    Status: "Kreirana",
                    
                };
                $.ajax({
                    type: 'POST',
                    url: '/api/Voznja',
                    data: JSON.stringify(Voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert("Dodata voznja");
                            $(location).attr('href', 'Korisnik.html');
                        }
                        else {
                            alert("Voznja nije dodata!");
                        }
                    },
                    error: function (errorData) {

                    }
                })
            });















            $("#odjavaD").click(function () {
                localStorage.removeItem("ulogovani");
                let koje = "";
                let trenutniKorisnik = "";
                $(location).attr('href', 'Index.html');
            });

            $("#homeD").click(function () {

                $("#pregledProfilaDivD").css("display", "none");
                $("#izmenaProfilaDivD").css("display", "none");
                $("#dodajVozacaDivD").css("display", "none");
                $("#dodajVoznjuDivD").css("display", "none");
                $("#tabeleD").css("display", "inline");
                $("#dodajKomentarD").css("display", "none");
                $("#prikaziKomentarD").css("display", "none");
            });

            $("#pregledProfilaD").click(function () {

                $("#pregledProfilaDivD").css("display", "inline");
                $("#izmenaProfilaDivD").css("display", "none");
                $("#dodajVozacaDivD").css("display", "none");
                $("#dodajVoznjuDivD").css("display", "none");
                $("#tabeleD").css("display", "none");


                $("#korisnickoImeD").text(trenutniKorisnik.KorisnickoIme);
                $("#lozinkaD").text(trenutniKorisnik.Lozinka);
                $("#imeD").text(trenutniKorisnik.Ime);
                $("#prezimeD").text(trenutniKorisnik.Prezime);
                if (trenutniKorisnik.Pol == 0) {
                    let musko = "<i class=\"fa fa-mars w3-xlarge\"></i>";
                    $("#polD").html(musko);
                } else {
                    let zensko = "<i class=\"fa fa-venus w3-xlarge\"></i>";
                    $("#polD").html(zensko);
                }
                $("#jmbgD").html(trenutniKorisnik.JMBG);
                $("#kontaktD").html(trenutniKorisnik.Kontakt);
                $("#emailD").html(trenutniKorisnik.Email);

            });

            $("#izmenaProfilaD").click(function () {

                $("#izmenaProfilaDivD").css("display", "inline");
                $("#pregledProfilaDivD").css("display", "none");
                $("#dodajVozacaDivD").css("display", "none");
                $("#dodajVoznjuDivD").css("display", "none");
                $("#tabeleD").css("display", "none");

                let izmena = "<table class=\"w3-large\" border=1>";
                izmena += " <tr><td>Korisničko ime</td><td><input type=\"text\" name=\"KorisnickoIme\" id=\"korisnickoime\" value=\"" + trenutniKorisnik.KorisnickoIme + "\" required /></td></tr>";
                izmena += " <tr><td>Lozinka</td><td><input type=\"text\" name=\"Lozinka\" id=\"lozinka1\" value=\"" + trenutniKorisnik.Lozinka + "\" required /></td></tr>";
                izmena += " <tr><td>Ime</td><td><input type=\"text\" name=\"Ime\" id=\"ime1\" value=\" " + trenutniKorisnik.Ime + "\" required /></td></tr>";
                izmena += " <tr><td>Prezime</td><td><input type=\"text\" name=\"Prezime\" value=\" " + trenutniKorisnik.Prezime + "\" id=\"prezime1\" required /></td></tr>";

                izmena += " <tr><td>JMBG</td><td><input type=\"text\" name=\"JMBG\" id=\"jmbg1\" pattern=\"[0-9]{13}\" minlength=\"13\" maxlength=\"13\" value=\"" + trenutniKorisnik.JMBG + "\" required /></td></tr>";
                izmena += " <tr><td>Kontakt</td><td><input type=\"text\" name=\"Kontakt\" id=\"kontakt1\" minlength=\"6\" value=\" " + trenutniKorisnik.Kontakt + "\" required /></td></tr>";
                izmena += " <tr><td>Email</td><td><input type=\"email\" name=\"Email\" id=\"email1\" value=\" " + trenutniKorisnik.Email + "\" required /></td></tr></table>";

                $("#tabelaIzmenaD").html(izmena);

            });

            $("#izmeniD").click(function () {
                let korisnik = {
                    Id: trenutniKorisnik.Id,
                    KorisnickoIme: `${$('#korisnickoime').val()}`,
                    Lozinka: `${$('#lozinka1').val()}`,
                    Ime: `${$('#ime1').val()}`,
                    Prezime: `${$('#prezime1').val()}`,
                    Pol: trenutniKorisnik.Pol,
                    JMBG: `${$('#jmbg1').val()}`,
                    Kontakt: `${$('#kontakt1').val()}`,
                    Email: `${$('#email1').val()}`,
                    Voznje: trenutniKorisnik.Voznje,
                    Uloga: trenutniKorisnik.Uloga,
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Dispecer/' + trenutniKorisnik.Id,
                    data: JSON.stringify(korisnik),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert("Uspesna izmena");
                            localStorage.setItem("ulogovani", korisnik.KorisnickoIme);
                            $(location).attr('href', 'Korisnik.html');
                        }
                        else {
                            alert("Korisnicko ime je zauzeto!");
                        }
                    },
                    error: function (errorData) {

                    }
                })
            });


            $("#PlusD").click(function () {

                $("#izmenaProfilaDivD").css("display", "none");
                $("#pregledProfilaDivD").css("display", "none");
                $("#dodajVozacaDivD").css("display", "inline");
                $("#dodajVoznjuDivD").css("display", "none");
                $("#tabeleD").css("display", "none");

            });
            $("#registracijaV").click(function () {
                let adresa = {
                    Ulica: `${$('#ulicaVD').val()}`,
                    Broj: `${$('#brojVD').val()}`,
                    Mesto: `${$('#mestoVD').val()}`,
                    Zip: `${$('#zipVD').val()}`,
                };
                let lokacija = {
                    X: `${$('#xVD').val()}`,
                    Y: `${$('#yVD').val()}`,
                    Adresa: adresa,
                };

                let e = document.getElementById('tipAutoVD');
                let selValue = e.options[e.selectedIndex].text;

                let automobil = {
                    Godiste: `${$('#godisteVD').val()}`,
                    Registracija: `${$('#regVD').val()}`,
                    BrojVozila: `${$('#brVD').val()}`,
                    TipAutomobila: selValue,
                };

                let e1 = document.getElementById('polVD');
                let selValue1 = e.options[e.selectedIndex].text;

                let vozac = {
                    KorisnickoIme: `${$('#korisnickoimeVD').val()}`,
                    Lozinka: `${$('#lozinkaVD').val()}`,
                    Ime: `${$('#imeVD').val()}`,
                    Prezime: `${$('#prezimeVD').val()}`,
                    Pol: selValue1,
                    JMBG: `${$('#jmbgVD').val()}`,
                    Kontakt: `${$('#kontaktVD').val()}`,
                    Email: `${$('#emailVD').val()}`,
                    Lokacija: lokacija,
                    Automobil: automobil,

                };



                $.ajax({
                    type: 'POST',
                    url: '/api/Vozac',
                    data: JSON.stringify(vozac),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert("Registrovali ste vozaca");
                            $(location).attr('href', 'Korisnik.html');
                        }
                        else {
                            alert("Korisnicko ime ili broj vozila je zauzeto!");
                        }
                    },
                    error: function (errorData) {

                    }
                })
            });

            $("#PlusVoznjaD").click(function () {
                
                $("#izmenaProfilaDivD").css("display", "none");
                $("#pregledProfilaDivD").css("display", "none");
                $("#dodajVozacaDivD").css("display", "none");
                $("#tabeleD").css("display", "none");
                $("#dodajVoznjuD").html("");
               
                
                    let tabela = `<table border="1"><tr><td colspan="2">Lokacija</td></tr><tr><td>X</td><td><input type="number" name="X" id="xD" required /></td></tr>`;
                    tabela += `<tr><td>Y</td><td><input type="number" name="Y" id="yD" required /></td></tr>`;
                    tabela += `<tr><td colspan="2">Adresa</td></tr><tr><td>Ulica</td><td><input type="text" name="Ulica" id="ulicaD" required /></td></tr>`;
                    tabela += `<tr><td>Broj</td><td><input type="text" name="Broj" id="brojD" required /></td></tr>`;
                    tabela += `<tr><td>Mesto</td><td><input type="text" name="Mesto" id="mestoD" required /></td></tr>`;
                    tabela += `<tr><td>ZIP</td><td><input type="number" name="Zip" id="zipD" required /></td></tr>`;
                    tabela += `<tr><td>Tip Automobila</td><td><select name="Auto" id="autoD"><option>Svejedno</option><option>Putnički</option><option>Kombi</option></select></td></tr>`;
                    
                    tabela += `<tr><td colspan="2"><button id="dodajVoznjuDugmeD" type="button">Dodaj</button></td></tr></table>`;
                    
                    $("#dodajVoznjuD").append(tabela);
                
                

                
                
                $("#dodajVoznjuD").css("display", "inline");

            });

            $(document).on('click', '#dodajVoznjuDugmeD', function () {
                $.get("/api/Vozac", function (data, status) {

                    let e = document.getElementById('autoD');
                    let selValue = e.options[e.selectedIndex].text;

                    let tip = selValue;
                    let tipBr = "";
                    if (tip == "Svejedno") {
                        tipBr = 0;
                    } else if (tip == "Putnički") {
                        tipBr = 1;
                    } else {
                        tipBr = 2;
                    }
               let tabela = `<table><tr><td>Vozač</td><td><select name="Vozac" id="vozacD">`;
               let brojac = 0;
               for (vozac in data) {
                   if (data[vozac].Zauzet == false) {
                       if (tipBr == 0) {
                           tabela += `<option>` + data[vozac].KorisnickoIme + `</option>`;
                           brojac++;
                       } else if (data[vozac].Automobil.TipAutomobila == tipBr){
                           tabela += `<option>` + data[vozac].KorisnickoIme + `</option>`;
                           brojac++;
                       }
                        
                    }
                }

               tabela += `</select></td></tr><tr><td colspan="2"><button id="dodajVoznjuDugme2D" type="button">Dodeli</button></td></tr></table>`;
               if (brojac == 0) {
                   alert("ne postoji slobodan vozač, vožnja neće biti formirana!");
                   $("#dodajVoznjuD").html("");
                   $("#dodajVoznjuD").css("display", "none");
                   $(location).attr('href', 'Korisnik.html');
               }
               $("#dodajVoznjuD").append(tabela);
                });
            });
            $(document).on('click', '#dodajVoznjuDugme2D', function () {


                let adresa = {
                    Ulica: `${$('#ulicaD').val()}`,
                    Broj: `${$('#brojD').val()}`,
                    Mesto: `${$('#mestoD').val()}`,
                    Zip: `${$('#zipD').val()}`,
                };
                let lokacija = {
                    X: `${$('#xD').val()}`,
                    Y: `${$('#yD').val()}`,
                    Adresa: adresa,
                };

                let e = document.getElementById('autoD');
                let selValue = e.options[e.selectedIndex].text;
                let e1 = document.getElementById('vozacD');
                let selValue1 = e1.options[e1.selectedIndex].text;

                let Voznja = {
                    Dispecer: trenutniKorisnik.KorisnickoIme,
                    PocetnaLokacija: lokacija,
                    TipAutomobila: selValue,
                    Vozac: selValue1,
                    Status: "Formirana",

                };
                $.ajax({
                    type: 'POST',
                    url: '/api/Voznja',
                    data: JSON.stringify(Voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert("Dodata voznja");
                            $(location).attr('href', 'Korisnik.html');
                        }
                        else {
                            alert("Voznja nije dodata!");
                        }
                    },
                    error: function (errorData) {

                    }
                })
            });












            $("#odjavaV").click(function () {
                localStorage.removeItem("ulogovani");
                let koje = "";
                let trenutniKorisnik = "";
                $(location).attr('href', 'Index.html');
            });

            $("#homeV").click(function () {

                $("#pregledProfilaDivV").css("display", "none");
                $("#izmenaProfilaDivV").css("display", "none");
                
                $("#dodajKomentarV").css("display", "none");
                $("#prikaziKomentarV").css("display", "none");
                $("#uspesnaVoznjaV").css("display", "none");
                $("#tabeleV").css("display", "inline");
                $("#dodajKomentarNeuspesnaV").css("display", "none");
                
            });

            $("#pregledProfilaV").click(function () {

                $("#pregledProfilaDivV").css("display", "inline");
                $("#izmenaProfilaDivV").css("display", "none");
                $("#dodajKomentarV").css("display", "none");
                $("#prikaziKomentarV").css("display", "none");
                $("#tabeleV").css("display", "none");
                $("#uspesnaVoznjaV").css("display", "none");


                $("#korisnickoImeV").text(trenutniKorisnik.KorisnickoIme);
                $("#lozinkaV").text(trenutniKorisnik.Lozinka);
                $("#imeV").text(trenutniKorisnik.Ime);
                $("#prezimeV").text(trenutniKorisnik.Prezime);
                if (trenutniKorisnik.Pol == 0) {
                    let musko = "<i class=\"fa fa-mars w3-xlarge\"></i>";
                    $("#polV").html(musko);
                } else {
                    let zensko = "<i class=\"fa fa-venus w3-xlarge\"></i>";
                    $("#polV").html(zensko);
                }
                $("#jmbgV").html(trenutniKorisnik.JMBG);
                $("#kontaktV").html(trenutniKorisnik.Kontakt);
                $("#emailV").html(trenutniKorisnik.Email);
                $("#lokacijaV").html(trenutniKorisnik.Lokacija.Adresa.Ulica + " " + trenutniKorisnik.Lokacija.Adresa.Broj);
                if (trenutniKorisnik.Automobil.TipAutomobila == 0) {
                    $("#automobilV").html("Putnički");
                } else {
                    $("#automobilV").html("Kombi");
                }
               

            });

            $("#izmenaProfilaV").click(function () {

                $("#izmenaProfilaDivV").css("display", "inline");
                $("#pregledProfilaDivV").css("display", "none");
                $("#dodajKomentarV").css("display", "none");
                $("#prikaziKomentarV").css("display", "none");
                $("#tabeleV").css("display", "none");
                $("#uspesnaVoznjaV").css("display", "none");
                

                let izmena = "<table class=\"w3-large\" border=1>";
                izmena += " <tr><td>Korisničko ime</td><td><input type=\"text\" name=\"KorisnickoIme\" id=\"korisnickoime\" value=\"" + trenutniKorisnik.KorisnickoIme + "\" required /></td></tr>";
                izmena += " <tr><td>Lozinka</td><td><input type=\"text\" name=\"Lozinka\" id=\"lozinka1\" value=\"" + trenutniKorisnik.Lozinka + "\" required /></td></tr>";
                izmena += " <tr><td>Ime</td><td><input type=\"text\" name=\"Ime\" id=\"ime1\" value=\" " + trenutniKorisnik.Ime + "\" required /></td></tr>";
                izmena += " <tr><td>Prezime</td><td><input type=\"text\" name=\"Prezime\" value=\" " + trenutniKorisnik.Prezime + "\" id=\"prezime1\" required /></td></tr>";

                izmena += " <tr><td>JMBG</td><td><input type=\"text\" name=\"JMBG\" id=\"jmbg1\" pattern=\"[0-9]{13}\" minlength=\"13\" maxlength=\"13\" value=\"" + trenutniKorisnik.JMBG + "\" required /></td></tr>";
                izmena += " <tr><td>Kontakt</td><td><input type=\"text\" name=\"Kontakt\" id=\"kontakt1\" minlength=\"6\" value=\" " + trenutniKorisnik.Kontakt + "\" required /></td></tr>";
                izmena += " <tr><td>Email</td><td><input type=\"email\" name=\"Email\" id=\"email1\" value=\" " + trenutniKorisnik.Email + "\" required /></td></tr>";
                izmena += " <tr><td colspan=\"2\">Lokacija</td></tr><tr><td>X</td><td><input type=\"number\" name=\"X\" id=\"xV\" value=\"" + trenutniKorisnik.Lokacija.X + "\" required /></td ></tr > ";
                izmena += " <tr><td>Y</td><td><input type=\"number\" name=\"Y\" id=\"yV\" value=\"" + trenutniKorisnik.Lokacija.Y + "\" required /></td ></tr >";
                izmena += " <tr><td colspan=\"2\">Adresa</td></tr><tr><td>Ulica</td><td><input type=\"text\" name=\"Ulica\" id=\"ulicaV\" value=\"" + trenutniKorisnik.Lokacija.Adresa.Ulica + "\" required /></td ></tr >";
                izmena += " <tr><td>Broj</td><td><input type=\"text\" name=\"Broj\" id=\"brojV\" value=\"" + trenutniKorisnik.Lokacija.Adresa.Broj + "\" required /></td ></tr>";
                izmena += " <tr><td>Mesto</td><td><input type=\"text\" name=\"Mesto\" id=\"mestoV\" value=\"" + trenutniKorisnik.Lokacija.Adresa.Mesto + "\" required /></td ></tr>";
                izmena += " <tr><td>ZIP</td><td><input type=\"number\" name=\"Zip\" id=\"zipV\" pattern=\"[0-9]{5}\" minlength=\"5\" maxlength=\"5\" value=\"" + trenutniKorisnik.Lokacija.Adresa.Zip + "\" required /></td></tr>";
                izmena += " <tr><td colspan=\"2\">Automobil</td></tr>";
                izmena += " <tr><td>Godište</td><td><input type=\"number\" name=\"Godiste\" id=\"godisteV\" value=\"" + trenutniKorisnik.Automobil.Godiste + "\" required/></td></tr>";
                izmena += " <tr><td>Registracija</td><td><input type=\"text\" name=\"Registracija\" id=\"regV\" value=\"" + trenutniKorisnik.Automobil.Registracija + "\" required /></td></tr>";
                izmena += " <tr><td>Broj Vozila</td><td><input type=\"number\" name=\"BrojVozila\" id=\"brV\" value=\"" + trenutniKorisnik.Automobil.BrojVozila + "\" required /></td></tr>";
                if (trenutniKorisnik.Automobil.TipAutomobila == 0) {
                    izmena += " <tr><td>Tip</td><td><select name=\"TipAutomobila\" id=\"tipAutoV\"><option selected>Putnički</option><option>Kombi</option></select></td></tr></table>";

                } else {
                    izmena += " <tr><td>Tip</td><td><select name=\"TipAutomobila\" id=\"tipAutoV\"><option>Putnički</option><option selected>Kombi</option></select></td></tr></table>";

                }
                
                $("#tabelaIzmenaV").html(izmena);

            });

            $("#izmeniV").click(function () {
                let adresa = {
                    Ulica: `${$('#ulicaV').val()}`,
                    Broj: `${$('#brojV').val()}`,
                    Mesto: `${$('#mestoV').val()}`,
                    Zip: `${$('#zipV').val()}`,
                };
                let lokacija = {
                    X: `${$('#xV').val()}`,
                    Y: `${$('#yV').val()}`,
                    Adresa: adresa,
                };

                let e = document.getElementById('tipAutoV');
                let selValue = e.options[e.selectedIndex].text;

                let automobil = {
                    Godiste: `${$('#godisteV').val()}`,
                    Registracija: `${$('#regV').val()}`,
                    BrojVozila: `${$('#brV').val()}`,
                    TipAutomobila: selValue,
                };

                let korisnik = {
                    Id: trenutniKorisnik.Id,
                    KorisnickoIme: `${$('#korisnickoime').val()}`,
                    Lozinka: `${$('#lozinka1').val()}`,
                    Ime: `${$('#ime1').val()}`,
                    Prezime: `${$('#prezime1').val()}`,
                    Pol: trenutniKorisnik.Pol,
                    JMBG: `${$('#jmbg1').val()}`,
                    Kontakt: `${$('#kontakt1').val()}`,
                    Email: `${$('#email1').val()}`,
                    Voznje: trenutniKorisnik.Voznje,
                    Uloga: trenutniKorisnik.Uloga,
                    Lokacija: lokacija,
                    Automobil: automobil,
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Vozac/' + trenutniKorisnik.Id,
                    data: JSON.stringify(korisnik),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert("Uspesna izmena");
                            localStorage.setItem("ulogovani", korisnik.KorisnickoIme);
                            $(location).attr('href', 'Korisnik.html');
                        }
                        else {
                            alert("Korisnicko ime je zauzeto!");
                        }
                    },
                    error: function (errorData) {

                    }
                })
            });

            

        });

        function openCity(evt, cityName) {
            $("#London").html("");
            $("#Paris").html("");
            $("#Tokyo").html("");

            $.get("/api/Voznja", function (data, status) {

                if (cityName == "London") {
                    let ulogovani = localStorage.getItem("ulogovani");
                    let tableOfProducts = "<table><tr><td>Datum</td><td>Početna lokacija</td><td>Odredište</td> <td>Vozač</td> <td>Mušterija</td> <td>Iznos</td> <td>Status</td> <td>Komentar</td></tr>";
                    for (voznja in data) {
                        if (data[voznja].Dispecer == ulogovani) {
                            tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Odrediste.Adresa.Ulica} ${data[voznja].Odrediste.Adresa.Broj}</td><td>${data[voznja].Vozac}</td><td>${data[voznja].Musterija}</td><td>${data[voznja].Iznos}</td>`;


                            switch (data[voznja].Status) {
                                case 0:
                                    tableOfProducts += `<td>Kreirana-Na čekanju</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 1:
                                    tableOfProducts += `<td>Formirana</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 2:
                                    tableOfProducts += `<td>Obrađena</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 3:
                                    tableOfProducts += `<td>Prihvaćena</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 4:
                                    tableOfProducts += `<td>Otkazana</td>`;
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickD(${data[voznja].Id});">Vidi komentar</button></td>`;

                                    break;
                                case 5:
                                    tableOfProducts += `<td>Uspešna</td>`;
                                    if (data[voznja].Komentar.Opis == null) {
                                        tableOfProducts += `<td><button id="dodajKomentar${data[voznja].Id}" type="button" onclick="dodajKomentarClickD(${data[voznja].Id});">Dodaj komentar</button></td>`;

                                    } else {
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickD(${data[voznja].Id});">Vidi komentar</button></td>`;

                                    }
                                    break;
                                case 6:
                                    tableOfProducts += `<td>Neuspešna</td>`;
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickD(${data[voznja].Id});">Vidi komentar</button></td>`;

                                    break;

                            }

                        }
                    }
                    tableOfProducts += "</table>";
                    $("#London").append(tableOfProducts);
                } else if (cityName == "Paris") {
                    let tableOfProducts = "<table><tr><td>Datum</td> <td>Početna lokacija</td> <td>Odredište</td> <td>Vozač</td> <td>Mušterija</td> <td>Dispečer</td> <td>Iznos</td> <td>Status</td> <td>Komentar</td></tr>";
                    for (voznja in data) {
                        tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Odrediste.Adresa.Ulica} ${data[voznja].Odrediste.Adresa.Broj}</td><td>${data[voznja].Vozac}</td><td>${data[voznja].Musterija}</td><td>${data[voznja].Dispecer}</td><td>${data[voznja].Iznos}</td>`;

                        switch (data[voznja].Status) {
                            case 0:
                                tableOfProducts += `<td>Kreirana-Na čekanju</td>`;
                                tableOfProducts += `<td>Nema komentara</td>`;
                                break;
                            case 1:
                                tableOfProducts += `<td>Formirana</td>`;
                                tableOfProducts += `<td>Nema komentara</td>`;
                                break;
                            case 2:
                                tableOfProducts += `<td>Obrađena</td>`;
                                tableOfProducts += `<td>Nema komentara</td>`;
                                break;
                            case 3:
                                tableOfProducts += `<td>Prihvaćena</td>`;
                                tableOfProducts += `<td>Nema komentara</td>`;
                                break;
                            case 4:
                                tableOfProducts += `<td>Otkazana</td>`;
                                tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickD(${data[voznja].Id});">Vidi komentar</button></td>`;

                                break;
                            case 5:
                                tableOfProducts += `<td>Uspešna</td>`;
                                if (data[voznja].Komentar.Opis == null) {
                                    tableOfProducts += `<td><button id="dodajKomentar${data[voznja].Id}" type="button" onclick="dodajKomentarClickD(${data[voznja].Id});">Dodaj komentar</button></td>`;

                                } else {
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickD(${data[voznja].Id});">Vidi komentar</button></td>`;

                                }
                                break;
                            case 6:
                                tableOfProducts += `<td>Neuspešna</td>`;
                                tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickD(${data[voznja].Id});">Vidi komentar</button></td>`;

                                break;

                        }

                    }
                    tableOfProducts += "</table>";
                    $("#Paris").append(tableOfProducts);
                } else if (cityName == "Tokyo") {
                    let tableOfProducts = "<table><tr><td>Datum</td> <td>Početna lokacija</td> <td>Mušterija</td> <td>Tip Automobila</td></tr>";
                    for (voznja in data) {
                        if (data[voznja].Status == 0) {
                            tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Musterija}</td>`;
                            if (data[voznja].TipAutomobila == 0) {
                                tableOfProducts += `<td>Svejedno</td>`;
                            } else if (data[voznja].TipAutomobila == 1) {
                                tableOfProducts += `<td>Putnički</td>`;
                            } else if (data[voznja].TipAutomobila == 2) {
                                tableOfProducts += `<td>Kombi</td>`;
                            }

                            tableOfProducts += `<td><button id="obradi${data[voznja].Id}" type="button" onclick="obradiVoznjuClick(${data[voznja].Id});">Obradi Vožnju</button></td>`;

                        }
                    }
                    tableOfProducts += "</table>";
                    $("#Tokyo").append(tableOfProducts);

                }
            });


            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        function obradiVoznjuClick(id) {
            let voznja = "";
            $("#obradaVoznjeD").html("");
            $.get("/api/Voznja/" + id, function (data, status) {

                voznja = data;
            });
            
            $.get("/api/Vozac", function (data, status) {
                let tipBr = voznja.TipAutomobila;

                let tabela = `<table><tr><td>Vozač</td><td><select name="Vozac" id="vozacO">`;
                let brojac = 0;
                for (vozac in data) {
                    if (data[vozac].Zauzet == false) {
                        if (tipBr == 0) {
                            tabela += `<option>` + data[vozac].KorisnickoIme + `</option>`;
                            brojac++;
                        } else if (data[vozac].Automobil.TipAutomobila == tipBr) {
                            tabela += `<option>` + data[vozac].KorisnickoIme + `</option>`;
                            brojac++;
                        }

                    }
                }

                tabela += `</select></td></tr><tr><td colspan="2"><button id="obradiVoznju2D" onclick="obradiDugmeD(${voznja.Id});" type="button">Dodeli</button></td></tr></table>`;
                if (brojac == 0) {
                    alert("ne postoji slobodan vozač, vožnja ostaje na čekanju!");
                    $("#obradaVoznjeD").html("");
                    $("#obradaVoznjeD").css("display", "none");
                    $(location).attr('href', 'Korisnik.html');
                }
                $("#obradaVoznjeD").append(tabela);
            });
            
            $("#obradaVoznjeD").css("display", "inline");
        }

        function obradiDugmeD(id) {
            let e = document.getElementById('vozacO');
            let selValue = e.options[e.selectedIndex].text;
            let value = selValue;

            let disp = localStorage.getItem("ulogovaniId");
            let dispecer = "";
            $.get("/api/Dispecer/" + disp, function (data, status) {

                localStorage.setItem("dispecer", data.KorisnickoIme);
               
            });

            dispecer = localStorage.getItem("dispecer");
            let voznja = {
                Vozac: value,
                Dispecer: dispecer,
                Status: "Obrađena",
            }

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + id,
                data: JSON.stringify(voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesna izmena");
                        $("#homeD").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })
            $("#obradaVoznjeD").css("display", "none");
        }




        function sortTableK() {
            var n = document.getElementById("SortK").value;
            if (n == 1) {
                n = 6;
            }
            var table, rows, switching, i, x, y, shouldSwitch;
            table = document.getElementById("musterijaVoznje");
            switching = true;
            /*Make a loop that will continue until
            no switching has been done:*/
            while (switching) {
                //start by saying: no switching is done:
                switching = false;
                rows = table.getElementsByTagName("TR");
                /*Loop through all table rows (except the
                first, which contains table headers):*/
                for (i = 2; i < (rows.length - 1); i++) {
                    //start by saying there should be no switching:
                    shouldSwitch = false;
                    /*Get the two elements you want to compare,
                    one from current row and one from the next:*/
                    x = rows[i].getElementsByTagName("TD")[0];
                    y = rows[i + 1].getElementsByTagName("TD")[0];
                    //check if the two rows should switch place:
                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                        //if so, mark as a switch and break the loop:
                        shouldSwitch = true;
                        break;
                    }
                }
                if (shouldSwitch) {
                    /*If a switch has been marked, make the switch
                    and mark that a switch has been done:*/
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                }
            }
        }


        //radi
        function izmeniVoznjuClick(id) {
            
            $("#izmenaVoznjeK").html("");
            $.get("/api/Voznja/" + id, function (data, status) {
                alert(data.PocetnaLokacija.X);
                localStorage.setItem("voznjaZaIzmenu", data.Id);
                let izmena = "<table border=\"1\"><tr><td colspan=\"2\">Vaša lokacija</td></tr>";
                izmena += "<tr><td>X</td><td><input type=\"number\" name=\"X\" id=\"xI\" value = \"" + data.PocetnaLokacija.X + "\" required /></td></tr>";
                izmena += "<tr><td>Y</td><td><input type=\"number\" name=\"Y\" id=\"yI\" value = \"" + data.PocetnaLokacija.Y + "\" required /></td></tr>";
                izmena += "<tr><td colspan=\"2\">Adresa</td></tr>";
                izmena += "<tr><td>Ulica</td><td><input type=\"text\" name=\"Ulica\" id=\"ulicaI\" value = \" " + data.PocetnaLokacija.Adresa.Ulica + "\" required /></td></tr>";
                izmena += "<tr><td>Broj</td><td><input type=\"text\" name=\"Broj\" id=\"brojI\" value = \" " + data.PocetnaLokacija.Adresa.Broj + "\" required /></td></tr>";
                izmena += "<tr><td>Mesto</td><td><input type=\"text\" name=\"Mesto\" id=\"mestoI\" value = \" " + data.PocetnaLokacija.Adresa.Mesto + "\" required /></td></tr>";
                izmena += "<tr><td>Zip</td><td><input type=\"number\" name=\"Zip\" id=\"zipI\" value=\"" + data.PocetnaLokacija.Adresa.Zip + "\" required/></td></tr>";
                
                if (data.TipAutomobila == 0) {
                    izmena += "<tr><td>Tip Automobila</td><td><select name=\"Auto\" id=\"autoI\"><option selected>Svejedno</option><option>Putnički</option><option>Kombi</option></select></td></tr>";

                } else if (data.TipAutomobila == 1) {
                    izmena += "<tr><td>Tip Automobila</td><td><select name=\"Auto\" id=\"autoI\"><option>Svejedno</option><option selected>Putnički</option><option>Kombi</option></select></td></tr>";

                } else {
                    izmena += "<tr><td>Tip Automobila</td><td><select name=\"Auto\" id=\"autoI\"><option>Svejedno</option><option selected>Putnički</option><option selected>Kombi</option></select></td></tr>";

                }
                izmena += "<tr><td colspan=\"2\"><button id=\"izmeniVoznju\" type=\"button\" onclick=\"izmeniVoznjuKlik();\">Izmeni Voznju</button></td></tr></table>";


                $("#izmenaVoznjeK").append(izmena);

            });
            $("#izmenaVoznjeK").css("display", "inline");
        }


        function vidiKomentarClick(id) {
            $.get("/api/Voznja/" + id, function (data, status) {

                $("#opisP").text(data.Komentar.Opis);
                $("#datumP").text(data.Komentar.DatumObjave);
                $("#korisnikP").text(data.Komentar.Korisnik);
                $("#OcenaP").text(data.Komentar.Ocena);

                
            });

            $("#prikaziKomentarK").css("display", "inline");

        }
        function zatvoriKomentarK() {
           
            $("#prikaziKomentarK").css("display", "none");
        }
        function vidiKomentarClickD(id) {
            $.get("/api/Voznja/" + id, function (data, status) {

                $("#opisPD").text(data.Komentar.Opis);
                $("#datumPD").text(data.Komentar.DatumObjave);
                $("#korisnikPD").text(data.Komentar.Korisnik);
                $("#OcenaPD").text(data.Komentar.Ocena);


            });

            $("#prikaziKomentarD").css("display", "inline");

        }
        function zatvoriKomentarD() {
           
            $("#prikaziKomentarD").css("display", "none");
        }

        //radi
        function izmeniVoznjuKlik() {

           
            let IdIzmene = localStorage.getItem("voznjaZaIzmenu");
            
            let adresa = {
                Ulica: `${$('#ulicaI').val()}`,
                Broj: `${$('#brojI').val()}`,
                Mesto: `${$('#mestoI').val()}`,
                Zip: `${$('#zipI').val()}`,
            };
            let lokacija = {
                X: `${$('#xI').val()}`,
                Y: `${$('#yI').val()}`,
                Adresa: adresa,
            };

            let e = document.getElementById('autoI');
            let selValue = e.options[e.selectedIndex].text;

            let Voznja = {

                PocetnaLokacija: lokacija,
                TipAutomobila: selValue,
                Status: "Kreirana",

            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + IdIzmene,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesna izmena");
                        $("#homeK").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })
            $("#izmenaVoznjeK").css("display", "none");

        }
        //radi
        function otkaziVoznjuClick(id) {
            $("#dodajKomentarOtkaziK").css("display", "inline");
            localStorage.setItem("otkazanaVoznja", id);

            
            

        }
        //radi
        function dodajKomentarOtkaziDugmeK() {
            let v = localStorage.getItem("otkazanaVoznja");

            let ulogovani = localStorage.getItem("ulogovani");

            let komentar = {

                Opis: `${$('#opisKO').val()}`,
                DatumObjave: `${$('#datumObjaveKO').val()}`,
                Korisnik: ulogovani,
                Voznja: v,
                Ocena: `${$('#ocenaKO').val()}`,

            };

            let Voznja = {
                Id: v,
                Komentar: komentar,
                Status: "Otkazana",
            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + v,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        $("#dodajKomentarOtkaziK").css("display", "none");
                        $("#homeK").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })


        }


        function dodajKomentarClick(id) {
            $("#dodajKomentarK").css("display", "inline");
            localStorage.setItem("voznja", id);
        }

        function dodajKomentarDugmeK() {
            let v = localStorage.getItem("voznja");
            
            let ulogovani = localStorage.getItem("ulogovani");

            let komentar = {

                Opis: `${$('#opisK').val()}`,
                DatumObjave: `${$('#datumObjaveK').val()}`,
                Korisnik: ulogovani,
                Voznja: v,
                Ocena: `${$('#ocenaK').val()}`,

            };

            let Voznja = {
                Id: v,
                Komentar: komentar,
            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + v,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        $("#dodajKomentarK").css("display", "none");
                        $("#homeK").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })

           
        }





        function dodajKomentarClickD(id) {
            $("#dodajKomentarD").css("display", "inline");
            localStorage.setItem("otkazanaVoznja", id);
        }

        function dodajKomentarDugmeD() {
            let otkazanaVoznja = localStorage.getItem("otkazanaVoznja");
            let ulogovani = localStorage.getItem("ulogovani");

            let komentar = {

                Opis: `${$('#opisD').val()}`,
                DatumObjave: `${$('#datumObjaveD').val()}`,
                Korisnik: ulogovani,
                Voznja: otkazanaVoznja,
                Ocena: `${$('#ocenaD').val()}`,

            };

            let Voznja = {
                Id: otkazanaVoznja,
                Komentar: komentar,
            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + otkazanaVoznja,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesno dodat komentar");
                        $("#dodajKomentarD").css("display", "none");
                        $("#homeD").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })


        }





       //radi
        function uspesnaClickV(id) {
            $("#uspesnaVoznjaV").css("display", "inline");
            localStorage.setItem("uspesnaVoznja", id);
        }
        //radi
        function uspesnaVoznjaDugmeV() {
            let voznjaId = localStorage.getItem("uspesnaVoznja");

            let adresa = {
                Ulica: `${$('#ulicaV').val()}`,
                Broj: `${$('#brojV').val()}`,
                Mesto: `${$('#mestoV').val()}`,
                Zip: `${$('#zipV').val()}`,
            };
            let lokacija = {
                X: `${$('#xV').val()}`,
                Y: `${$('#yV').val()}`,
                Adresa: adresa,
            };
            let Voznja = {

                Odrediste: lokacija,
                Iznos: `${$('#iznosV').val()}`,
                Status: "Uspešna",

            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + voznjaId,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesna izmena");
                        $("#homeV").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })
            $("#uspesnaVoznjaV").css("display", "none");

        }
        //radi
        function neuspesnaClickV(id) {
            $("#dodajKomentarNeuspesnaV").css("display", "inline");
            localStorage.setItem("neuspesnaVoznja", id);

        }
        //radi
        function dodajKomentarNeuspesnaDugmeV() {
            let neuspesnaVoznja = localStorage.getItem("neuspesnaVoznja");
            let ulogovani = localStorage.getItem("ulogovani");
            let komentar = {

                Opis: `${$('#opisVN').val()}`,
                DatumObjave: `${$('#datumObjaveVN').val()}`,
                Korisnik: ulogovani,
                Voznja: neuspesnaVoznja,
                Ocena: `${$('#ocenaVN').val()}`,

            };

            let Voznja = {
                Id: neuspesnaVoznja,
                Komentar: komentar,
                Status: "Neuspešna",
            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + neuspesnaVoznja,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesno dodat komentar");
                        $("#dodajKomentarNeuspesnaV").css("display", "none");
                        $("#homeV").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })


        }

        //radi
        function preuzmiVoznjuClick(id) {

            let value = localStorage.getItem("ulogovani");
            let voznja = {
                Vozac: value,
                Status: "Prihvaćena",
            }

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + id,
                data: JSON.stringify(voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesna izmena");
                        $("#homeV").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })
            
        }
        //radi
        function vidiKomentarClickV(id) {
            $.get("/api/Voznja/" + id, function (data, status) {

                $("#opisPV").text(data.Komentar.Opis);
                $("#datumPV").text(data.Komentar.DatumObjave);
                $("#korisnikPV").text(data.Komentar.Korisnik);
                $("#OcenaPV").text(data.Komentar.Ocena);


            });

            $("#prikaziKomentarV").css("display", "inline");

        }
        //radi
        function zatvoriKomentarV() {
            
            $("#prikaziKomentarV").css("display", "none");
        }

        function dodajKomentarClickV(id) {
            $("#dodajKomentarV").css("display", "inline");
            localStorage.setItem("otkazanaVoznja", id);
        }

        function dodajKomentarDugmeV() {
            let otkazanaVoznja = localStorage.getItem("otkazanaVoznja");
            let ulogovani = localStorage.getItem("ulogovani");
            let komentar = {

                Opis: `${$('#opisV').val()}`,
                DatumObjave: `${$('#datumObjaveV').val()}`,
                Korisnik: ulogovani,
                Voznja: otkazanaVoznja,
                Ocena: `${$('#ocenaV').val()}`,

            };

            let Voznja = {
                Id: otkazanaVoznja,
                Komentar: komentar,
            };

            $.ajax({
                type: 'PUT',
                url: '/api/Voznja/' + otkazanaVoznja,
                data: JSON.stringify(Voznja),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        alert("Uspesno dodat komentar");
                        $("#dodajKomentarV").css("display", "none");
                        $("#homeV").click();

                    }
                    else {
                        alert("neuspesna izmena!");
                    }
                },
                error: function (errorData) {

                }
            })


        }

        function openCityV(evt, cityName) {
            $("#LondonV").html("");
            $("#TokyoV").html("");

            let id = localStorage.getItem("ulogovaniId");

            $.get("/api/Vozac/" + id, function (data, status) {
                localStorage.setItem("ulogovaniStatus", data.Zauzet);
            })
            $.get("/api/Voznja", function (data, status) {

                if (cityName == "LondonV") {
                    let ulogovani = localStorage.getItem("ulogovani");
                    let tableOfProducts = "<table><tr><td>Datum</td><td>Početna lokacija</td><td>Odredište</td> <td>Dispečer</td> <td>Mušterija</td> <td>Iznos</td> <td>Status</td> <td>Komentar</td><td></td></tr>";
                    for (voznja in data) {
                        if (data[voznja].Vozac == ulogovani) {
                            tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Odrediste.Adresa.Ulica} ${data[voznja].Odrediste.Adresa.Broj}</td><td>${data[voznja].Dispecer}</td><td>${data[voznja].Musterija}</td><td>${data[voznja].Iznos}</td>`;


                            switch (data[voznja].Status) {
                                case 0:
                                    tableOfProducts += `<td>Kreirana-Na čekanju</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    break;
                                case 1:
                                    tableOfProducts += `<td>Formirana</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    tableOfProducts += `<td><button id="uspesna${data[voznja].Id}" type="button" onclick="uspesnaClickV(${data[voznja].Id});">Uspešna</button>`;
                                    tableOfProducts += ` <button id="neuspesna${data[voznja].Id}" type="button" onclick="neuspesnaClickV(${data[voznja].Id});">Neuspešna</button></td>`;

                                    break;
                                case 2:
                                    tableOfProducts += `<td>Obrađena</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    tableOfProducts += `<td><button id="uspesna${data[voznja].Id}" type="button" onclick="uspesnaClickV(${data[voznja].Id});">Uspešna</button>`;
                                    tableOfProducts += ` <button id="neuspesna${data[voznja].Id}" type="button" onclick="neuspesnaClickV(${data[voznja].Id});">Neuspešna</button></td>`;

                                    break;
                                case 3:
                                    tableOfProducts += `<td>Prihvaćena</td>`;
                                    tableOfProducts += `<td>Nema komentara</td>`;
                                    tableOfProducts += `<td><button id="uspesna${data[voznja].Id}" type="button" onclick="uspesnaClickV(${data[voznja].Id});">Uspešna</button>`;
                                    tableOfProducts += ` <button id="neuspesna${data[voznja].Id}" type="button" onclick="neuspesnaClickV(${data[voznja].Id});">Neuspešna</button></td>`;

                                    break;
                                case 4:
                                    tableOfProducts += `<td>Otkazana</td>`;
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickV(${data[voznja].Id});">Vidi komentar</button></td>`;

                                    break;
                                case 5:
                                    tableOfProducts += `<td>Uspešna</td>`;
                                    if (data[voznja].Komentar.Opis == null) {
                                        tableOfProducts += `<td><button id="dodajKomentar${data[voznja].Id}" type="button" onclick="dodajKomentarClickV(${data[voznja].Id});">Dodaj komentar</button></td>`;

                                    } else {
                                        tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickV(${data[voznja].Id});">Vidi komentar</button></td>`;

                                    }
                                    break;
                                case 6:
                                    tableOfProducts += `<td>Neuspešna</td>`;
                                    tableOfProducts += `<td><button id="vidiKomentar${data[voznja].Id}" type="button" onclick="vidiKomentarClickV(${data[voznja].Id});">Vidi komentar</button></td>`;

                                    break;

                            }

                        }
                    }
                    tableOfProducts += "</table>";
                    $("#LondonV").append(tableOfProducts);
                } else if (cityName == "TokyoV") {
                    let tip = localStorage.getItem("ulogovaniTip");
                    let status = localStorage.getItem("ulogovaniStatus");
                    let tableOfProducts = "<table><tr><td>Datum</td> <td>Početna lokacija</td> <td>Mušterija</td> <td>Tip Automobila</td></tr>";
                    for (voznja in data) {
                        if (data[voznja].Status == 0 && (data[voznja].TipAutomobila == tip || data[voznja].TipAutomobila==0)) {
                            tableOfProducts += `<tr><td>${data[voznja].Datum}</td><td>${data[voznja].PocetnaLokacija.Adresa.Ulica} ${data[voznja].PocetnaLokacija.Adresa.Broj}</td><td>${data[voznja].Musterija}</td>`;
                            if (data[voznja].TipAutomobila == 0) {
                                tableOfProducts += `<td>Svejedno</td>`;
                            } else if (data[voznja].TipAutomobila == 1) {
                                tableOfProducts += `<td>Putnički</td>`;
                            } else if (data[voznja].TipAutomobila == 2) {
                                tableOfProducts += `<td>Kombi</td>`;
                            }

                            if (status == "true") {
                                tableOfProducts += `<td><button id="preuzmi${data[voznja].Id}" type="button" onclick="preuzmiVoznjuClick(${data[voznja].Id});" disabled>Preuzmi Vožnju</button></td>`;

                            } else {
                                tableOfProducts += `<td><button id="preuzmi${data[voznja].Id}" type="button" onclick="preuzmiVoznjuClick(${data[voznja].Id});">Preuzmi Vožnju</button></td>`;

                            }
                            
                        }
                    }
                    tableOfProducts += "</table>";
                    $("#TokyoV").append(tableOfProducts);

                }
            });


            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }

    </script>
</head>
<body>
    <div class="musterija">
        <div class="w3-top">
            <div class="w3-bar " style=" background-color:#f176ad">
                <img class="w3-bar-item w3-left w3-small " src="logo.jpg" height="60" width="60" />
                <a href="#" id="homeK" class="w3-bar-item w3-button w3-padding-large w3-large w3-left " style=" background-color:#ee1790"><i class="fa fa-home"></i></a>
                <div class="w3-dropdown-hover w3-hide-small w3-large w3-left">
                    <button class="w3-button w3-padding-large" title="Account"><i class="fa fa-user"></i></button>
                    <div class="w3-dropdown-content w3-card-4 w3-bar-block" style="width:300px">
                        <a href="#" id="pregledProfilaK" class="w3-bar-item w3-button">Pregled profila</a>
                        <a href="#" id="izmenaProfilaK" class="w3-bar-item w3-button">Izmeni profil</a>
                        <a href="#" id="odjavaK" class="w3-bar-item w3-button">Odjavi se</a>

                    </div>
                </div>
                <a href="#" id="PlusK" class="w3-bar-item w3-button w3-padding-large w3-large w3-left" title="Nova vožnja"><i class="fa fa-plus"></i></a>
            </div>
        </div>

        <div class="w3-container w3-content" style="max-width:1700px;margin-top:80px">
            <div id="pregledProfilaDivK">
                <div class="w3-card w3-left w3-padding-large">
                    <h5 id="korisnickoImeK" class="fa fa-user-circle w3-xxlarge"></h5>
                    <br />
                    <p id="lozinkaK" class="fa fa-key w3-xlarge"></p><br />
                    <p id="imeK" class="fa fa-genderless w3-xlarge"></p><br />
                    <p id="prezimeK" class="fa fa-genderless w3-xlarge"></p><br />
                    <p id="polK"></p>
                    <p id="jmbgK" class="fa fa-birthday-cake w3-xlarge"></p><br />
                    <p id="kontaktK" class="fa fa-phone w3-xlarge"></p><br />
                    <p id="emailK" class="fa fa-at w3-xlarge"></p><br />
                </div>
            </div>

            <div id="izmenaProfilaDivK">
                <div id="tabelaIzmenaK">

                </div>
                <button id="izmeniK" type="button">Izmeni</button>
            </div>

            <!--nije gotovo-->
            <div id="dodajVoznjuDivK">
                <div id="tabelaDodajVoznju">
                    <table border="1">
                        <tr><td colspan="2">Vaša lokacija</td></tr>
                        <tr><td>X</td><td><input type="number" name="X" id="xK" required /></td></tr>
                        <tr><td>Y</td><td><input type="number" name="Y" id="yK" required /></td></tr>
                        <tr><td colspan="2">Adresa</td></tr>
                        <tr><td>Ulica</td><td><input type="text" name="Ulica" id="ulicaK" required /></td></tr>
                        <tr><td>Broj</td><td><input type="text" name="Broj" id="brojK" required /></td></tr>
                        <tr><td>Mesto</td><td><input type="text" name="Mesto" id="mestoK" required /></td></tr>
                        <tr><td>ZIP</td><td><input type="number" name="Zip" id="zipK" required /></td></tr>
                        <tr>
                            <td>Tip Automobila</td>
                            <td>
                                <select name="Auto" id="autoK">
                                    <option>Svejedno</option>
                                    <option>Putnički</option>
                                    <option>Kombi</option>
                                </select>
                            </td>
                        </tr>
                        <tr><td colspan="2"><button id="dodajVoznjuK" type="button">Dodaj</button></td></tr>
                    </table>
                </div>

            </div>
            <div id="pretragaK">
                <table id="tableK">
                    <tr>
                        <td>
                            <select name="Status" id="statusPretragaK">
                                <option value="-1">Status</option>
                                <option value="0">Kreirana</option>
                                <option value="1">Formirana</option>
                                <option value="2">Obrađena</option>
                                <option value="3">Prihvaćena</option>
                                <option value="4">Otkazana</option>
                                <option value="5">Uspešna</option>
                                <option value="6">Neuspešna</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                    <tr>
                        <td>Datum od</td>
                        <td>Datum do</td>
                    </tr>
                    <tr>
                        <td><input type="date" name="DatumOdK" id="DatumOdK" /></td>
                        <td><input type="date" name="DatumDoK" id="DatumDoK" /></td>
                        <td>
                            <select name="Ocena" id="ocenaPretragaOdK">
                                <option value="0">Ocena od</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </td>
                        <td>
                            <select name="Ocena" id="ocenaPretragaDoK">
                                <option value="5">Ocena do</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </td>
                        <td>
                            <input type="number"  name="cenaOdK" id="cenaOdK" placeholder="Cena od" />
                        </td>
                        <td>
                            <input type="number"  name="cenaDoK" id="cenaDoK" placeholder="Cena do" />
                        </td>
                    </tr>
                    
                    <tr>
                        <td>
                            Sortiraj po:
                        </td>
                        <td>
                            <select name="SortK" id="SortK" onchange="sortTableK()">
                                <option value="0">Datumu(Najnoviji)</option>
                                <option value="1">Oceni(najveća-najmanja) </option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><button id="refreshK" type="button"><i class="fa fa-undo"></i></button></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        
                        <td><button id="pretraziK" type="button"><i class="fa fa-check-circle"></i></button></td>

                    </tr>
                </table>

            </div>

            <div id="tabelaMojeVoznjeK">

            </div>
            <div id="izmenaVoznjeK" class="w3-right">

            </div>
            <div id="dodajKomentarK" class="w3-right">
                <table border="1">
                    <tr>
                        <td colspan="2">Dodaj Komentar</td>
                    </tr>
                    <tr>
                        <td>Opis</td>
                        <td><input type="text" name="Opis" id="opisK" required /></td>
                    </tr>
                    <tr>
                        <td>Datum objave</td>
                        <td><input type="date" name="DatumObjave" id="datumObjaveK" required /></td>
                    </tr>
                    <tr>
                        <td>Ocena</td>
                        <td><input type="range" name="Ocena" id="ocenaK" min="0" max="5" /></td>
                    </tr>
                    <tr>
                        <td colspan="2"> <button onclick="dodajKomentarDugmeK();" type="button">Dodaj</button></td>

                    </tr>
                </table>
            </div>
            <div id="dodajKomentarOtkaziK" class="w3-right">
                <table border="1">
                    <tr>
                        <td colspan="2">Dodaj Komentar</td>
                    </tr>
                    <tr>
                        <td>Opis</td>
                        <td><input type="text" name="Opis" id="opisKO" required /></td>
                    </tr>
                    <tr>
                        <td>Datum objave</td>
                        <td><input type="date" name="DatumObjave" id="datumObjaveKO" required /></td>
                    </tr>
                    <tr>
                        <td>Ocena</td>
                        <td><input type="range" name="Ocena" id="ocenaKO" min="0" max="5" /></td>
                    </tr>
                    <tr>
                        <td colspan="2"> <button onclick="dodajKomentarOtkaziDugmeK();" type="button">Dodaj</button></td>

                    </tr>
                </table>
            </div>

            <div id="prikaziKomentarK" class="w3-right w3-large">
                <div class="w3-card w3-padding-large">

                    <p id="opisP" class="fa fa-pencil-alt"></p><br />
                    <p id="datumP" class="fa fa-calendar-alt"></p><br />
                    <p id="korisnikP" class="fa fa-user-circle"></p><br />
                    <p id="OcenaP" class="fa fa-star"></p><br />
                    <button id="gasiKom" onclick="zatvoriKomentarK();" class="fa fa-times"></button>
                </div>
            </div>
        </div>

    </div>

   
    <div class="vozac">
        <div class="w3-top">
            <div class="w3-bar " style=" background-color:#f176ad">
                <img class="w3-bar-item w3-left w3-small " src="logo.jpg" height="60" width="60" />
                <a href="#" id="homeV" class="w3-bar-item w3-button w3-padding-large w3-large w3-left " style=" background-color:#ee1790"><i class="fa fa-home"></i></a>
                <div class="w3-dropdown-hover w3-hide-small w3-large w3-left">
                    <button class="w3-button w3-padding-large" title="Account"><i class="fa fa-user"></i></button>
                    <div class="w3-dropdown-content w3-card-4 w3-bar-block" style="width:300px">
                        <a href="#" id="pregledProfilaV" class="w3-bar-item w3-button">Pregled profila</a>
                        <a href="#" id="izmenaProfilaV" class="w3-bar-item w3-button">Izmeni profil</a>
                        <a href="#" id="odjavaV" class="w3-bar-item w3-button">Odjavi se</a>

                    </div>
                </div>
            </div>
        </div>
        <div class="w3-container w3-content" style="max-width:1700px;margin-top:80px">
            <div id="pregledProfilaDivV">
                <div class="w3-card w3-left w3-padding-large">
                    <h5 id="korisnickoImeV" class="fa fa-user-circle w3-xxlarge"></h5>
                    <br />
                    <p id="lozinkaV" class="fa fa-key w3-xlarge"></p><br />
                    <p id="imeV" class="fa fa-genderless w3-xlarge"></p><br />
                    <p id="prezimeV" class="fa fa-genderless w3-xlarge"></p><br />
                    <p id="polV"></p>
                    <p id="jmbgV" class="fa fa-birthday-cake w3-xlarge"></p><br />
                    <p id="kontaktV" class="fa fa-phone w3-xlarge"></p><br />
                    <p id="emailV" class="fa fa-at w3-xlarge"></p><br />
                    <p id="lokacijaV" class="fa fa-map-marker w3-xlarge"></p><br />
                    <p id="automobilV" class="fa fa-car w3-xlarge"></p><br />
                </div>
            </div>

            <div id="izmenaProfilaDivV">
                <div id="tabelaIzmenaV">

                </div>
                <button id="izmeniV" type="button">Izmeni</button>
            </div>

            <div id="tabeleV" class="w3-left">

                <div class="tab">
                    <button class="tablinks" onclick="openCityV(event, 'LondonV')">Moje vožnje</button>
                    <button class="tablinks" onclick="openCityV(event, 'TokyoV')">Kreirane vožnje</button>
                </div>

                <div id="LondonV" class="tabcontent">

                </div>


                <div id="TokyoV" class="tabcontent">

                </div>

            </div>
            <div id="dodajKomentarV" class="w3-right">
                <table border="1">
                    <tr>
                        <td colspan="2">Dodaj Komentar</td>
                    </tr>
                    <tr>
                        <td>Opis</td>
                        <td><input type="text" name="Opis" id="opisV" required /></td>
                    </tr>
                    <tr>
                        <td>Datum objave</td>
                        <td><input type="date" name="DatumObjave" id="datumObjaveV" required /></td>
                    </tr>

                    <tr>
                        <td>Ocena</td>
                        <td><input type="range" name="Ocena" id="ocenaV" min="0" max="5" /></td>
                    </tr>
                    <tr>
                        <td colspan="2"> <button onclick="dodajKomentarDugmeV();" type="button">Dodaj</button></td>

                    </tr>
                </table>
            </div>
            <div id="dodajKomentarNeuspesnaV" class="w3-right">
                <table border="1">
                    <tr>
                        <td colspan="2">Dodaj Komentar</td>
                    </tr>
                    <tr>
                        <td>Opis</td>
                        <td><input type="text" name="Opis" id="opisVN" required /></td>
                    </tr>
                    <tr>
                        <td>Datum objave</td>
                        <td><input type="date" name="DatumObjave" id="datumObjaveVN" required /></td>
                    </tr>

                    <tr>
                        <td>Ocena</td>
                        <td><input type="range" name="Ocena" id="ocenaVN" min="0" max="5" /></td>
                    </tr>
                    <tr>
                        <td colspan="2"> <button onclick="dodajKomentarNeuspesnaDugmeV();" type="button">Dodaj</button></td>

                    </tr>
                </table>
            </div>
            <div id="prikaziKomentarV" class="w3-right w3-large">
                <div class="w3-card w3-padding-large">

                    <p id="opisPV" class="fa fa-pencil-alt"></p><br />
                    <p id="datumPV" class="fa fa-calendar-alt"></p><br />
                    <p id="korisnikPV" class="fa fa-user-circle"></p><br />
                    <p id="OcenaPV" class="fa fa-star"></p><br />
                    <button id="gasiKom" onclick="zatvoriKomentarV();" class="fa fa-times"></button>
                </div>
            </div>

            <div id="uspesnaVoznjaV">
                <table border="1">
                    <tr>
                        <td colspan="2">Odredište</td>
                    </tr>
                    <tr><td colspan="2">Lokacija</td></tr>
                    <tr><td>X</td><td><input type="number" name="X" id="xV" required /></td></tr>
                    <tr><td>Y</td><td><input type="number" name="Y" id="yV" required /></td></tr>
                    <tr><td colspan="2">Adresa</td></tr>
                    <tr><td>Ulica</td><td><input type="text" name="Ulica" id="ulicaV" required /></td></tr>
                    <tr><td>Broj</td><td><input type="text" name="Broj" id="brojV" required /></td></tr>
                    <tr><td>Mesto</td><td><input type="text" name="Mesto" id="mestoV" required /></td></tr>
                    <tr><td>ZIP</td><td><input type="number" name="Zip" id="zipV" required /></td></tr>
                    <tr>
                        <td>Iznos</td>
                        <td><input type="number" name="Iznos" id="iznosV" required /></td>
                    </tr>
                    <tr>
                        <td colspan="2"> <button onclick="uspesnaVoznjaDugmeV();" type="button">Dodaj</button></td>

                    </tr>
                </table>
            </div>
        </div>

    </div>

    <div class="dispecer">
        <div class="w3-top">
            <div class="w3-bar " style=" background-color:#f176ad">
                <img class="w3-bar-item w3-left w3-small " src="logo.jpg" height="60" width="60" />
                <a href="#" id="homeD" class="w3-bar-item w3-button w3-padding-large w3-large w3-left " style=" background-color:#ee1790"><i class="fa fa-home"></i></a>
                <div class="w3-dropdown-hover w3-hide-small w3-large w3-left">
                    <button class="w3-button w3-padding-large" title="Account"><i class="fa fa-user"></i></button>
                    <div class="w3-dropdown-content w3-card-4 w3-bar-block" style="width:300px">
                        <a href="#" id="pregledProfilaD" class="w3-bar-item w3-button">Pregled profila</a>
                        <a href="#" id="izmenaProfilaD" class="w3-bar-item w3-button">Izmeni profil</a>
                        <a href="#" id="odjavaD" class="w3-bar-item w3-button">Odjavi se</a>

                    </div>
                </div>
                <a href="#" id="PlusD" class="w3-bar-item w3-button w3-padding-large w3-large w3-left" title="Dodaj Vozača"><i class="fa fa-user-plus"></i></a>
                <a href="#" id="PlusVoznjaD" class="w3-bar-item w3-button w3-padding-large w3-large w3-left" title="Dodaj Vožnju"><i class="fa fa-plus"></i></a>
            </div>
        </div>

        <div class="w3-container w3-content" style="max-width:1700px;margin-top:80px">
            <div id="pregledProfilaDivD">

                <div class="w3-card w3-left w3-padding-large">
                    <h5 id="korisnickoImeD" class="fa fa-user-circle w3-xxlarge w3-center"></h5><br />
                    <p id="lozinkaD" class="fa fa-key w3-xlarge"></p><br />
                    <p id="imeD" class="fa fa-genderless w3-xlarge"></p><br />
                    <p id="prezimeD" class="fa fa-genderless w3-xlarge"></p><br />
                    <p id="polD"></p>
                    <p id="jmbgD" class="fa fa-birthday-cake w3-xlarge"></p><br />
                    <p id="kontaktD" class="fa fa-phone w3-xlarge"></p><br />
                    <p id="emailD" class="fa fa-at w3-xlarge"></p><br />
                </div>


            </div>

            <div id="izmenaProfilaDivD">
                <div id="tabelaIzmenaD">

                </div>
                <button id="izmeniD" type="button">Izmeni</button>
            </div>

            <div id="dodajVozacaDivD">
                <table class="w3-large" border="1">
                    <tr><td colspan="2" align="center"> Registracija Vozača</td></tr>
                    <tr><td>Korisničko ime</td><td><input type="text" name="KorisnickoIme" id="korisnickoimeVD" required /></td></tr>
                    <tr><td>Lozinka</td><td><input type="password" name="Lozinka" id="lozinkaVD" required /></td></tr>
                    <tr><td>Ime</td><td> <input type="text" name="Ime" id="imeVD" required /> </td> </tr>
                    <tr> <td>Prezime</td><td> <input type="text" name="Prezime" id="prezimeVD" required /> </td></tr>
                    <tr><td> Pol </td><td><select name="Pol" id="polVD"><option>Muški</option><option>Ženski</option></select></td></tr>
                    <tr> <td> JMBG</td> <td><input type="text" name="JMBG" id="jmbgVD" pattern="[0-9]{13}" minlength="13" maxlength="13" required /></td></tr>
                    <tr><td> Kontakt</td> <td><input type="text" name="Kontakt" id="kontaktVD" minlength="6" required /> </td> </tr>
                    <tr><td> Email </td> <td> <input type="email" name="Email" id="emailVD" required /></td></tr>
                    <tr><td colspan="2">Lokacija</td></tr>
                    <tr><td>X</td><td><input type="number" name="X" id="xVD" required /></td></tr>
                    <tr><td>Y</td><td><input type="number" name="Y" id="yVD" required /></td></tr>
                    <tr><td colspan="2">Adresa</td></tr>
                    <tr><td>Ulica</td><td><input type="text" name="Ulica" id="ulicaVD" required /></td></tr>
                    <tr><td>Broj</td><td><input type="text" name="Broj" id="brojVD" required /></td></tr>
                    <tr><td>Mesto</td><td><input type="text" name="Mesto" id="mestoVD" required /></td></tr>
                    <tr><td>ZIP</td><td><input type="number" name="Zip" id="zipVD" required /></td></tr>
                    <tr><td colspan="2">Automobil</td></tr>
                    <tr><td>Godište</td><td><input type="number" name="Godiste" id="godisteVD" required /></td></tr>
                    <tr><td>Registracija</td><td><input type="text" name="Registracija" id="regVD" required /></td></tr>
                    <tr><td>Broj Vozila</td><td><input type="number" name="BrojVozila" id="brVD" required /></td></tr>
                    <tr><td>Tip</td><td><select name="TipAutomobila" id="tipAutoVD"><option selected>Putnički</option><option>Kombi</option></select></td></tr>

                    <tr><td colspan="2"><button id="registracijaV" type="button">Registruj</button></td></tr>
                </table>
            </div>

            <div id="dodajVoznjuD">



            </div>

            <div id="tabeleD" class="w3-left">

                <div class="tab">
                    <button class="tablinks" onclick="openCity(event, 'London')">Moje vožnje</button>
                    <button class="tablinks" onclick="openCity(event, 'Paris')">Sve vožnje</button>
                    <button class="tablinks" onclick="openCity(event, 'Tokyo')">Kreirane vožnje</button>
                </div>

                <div id="London" class="tabcontent">

                </div>

                <div id="Paris" class="tabcontent">

                </div>

                <div id="Tokyo" class="tabcontent">

                </div>

            </div>
            <div id="dodajKomentarD" class="w3-right">
        <table border="1">
            <tr>
                <td colspan="2">Dodaj Komentar</td>
            </tr>
            <tr>
                <td>Opis</td>
                <td><input type="text" name="Opis" id="opisD" required /></td>
            </tr>
            <tr>
                <td>Datum objave</td>
                <td><input type="date" name="DatumObjave" id="datumObjaveD" required /></td>
            </tr>
            
            <tr>
                <td>Ocena</td>
                <td><input type="range" name="Ocena" id="ocenaD" min="0" max="5" /></td>
            </tr>
            <tr>
                <td colspan="2"> <button onclick="dodajKomentarDugmeD();" type="button">Dodaj</button></td>

            </tr>
        </table>
    </div>
    <div id="prikaziKomentarD" class="w3-right w3-large">
        <div class="w3-card w3-padding-large">

            <p id="opisPD" class="fa fa-pencil-alt"></p><br />
            <p id="datumPD" class="fa fa-calendar-alt"></p><br />
            <p id="korisnikPD" class="fa fa-user-circle"></p><br />
            <p id="OcenaPD" class="fa fa-star"></p><br />
            <button id="gasiKom" onclick="zatvoriKomentarD();" class="fa fa-times"></button>
        </div>
    </div>

            <div  id="obradaVoznjeD">

            </div>
        </div>
    </div>


    <script>

    </script>
</body>
</html>
